---
phase: 06-page-structure
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/www/components/Nav/MobileMenu.tsx
  - apps/www/components/Nav/index.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Mobile menu has solid background (content not visible through it)"
    - "Clicking outside mobile menu closes it"
    - "Only hamburger icon visible when menu closed, only X icon visible when menu open"
  artifacts:
    - path: "apps/www/components/Nav/MobileMenu.tsx"
      provides: "Mobile menu with solid background and click-outside-to-close"
    - path: "apps/www/components/Nav/index.tsx"
      provides: "Nav component that hides hamburger when menu open"
  key_links:
    - from: "MobileMenu.tsx backdrop div"
      to: "setOpen(false)"
      via: "onClick handler"
      pattern: "onClick.*setOpen.*false"
---

<objective>
Fix mobile navigation menu usability issues identified during Phase 6 verification.

Purpose: Close Gap 1 from VERIFICATION.md - mobile menu has transparent background, no click-outside-to-close, and icon overlap.

Output: Mobile menu with solid background color, click-outside-to-close functionality, and proper icon visibility management.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-page-structure/06-VERIFICATION.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add solid background and click-outside-to-close to MobileMenu</name>
  <files>apps/www/components/Nav/MobileMenu.tsx</files>
  <action>
    Fix mobile menu usability issues:

    1. **Add solid background to main menu container** (line 215):
       - The container uses `bg-overlay` which may have transparency
       - Change `bg-overlay` to `bg-background` for a solid background
       - Alternatively, add explicit opacity: `bg-background/100` or `bg-[hsl(var(--background-default))]`

    2. **Add click-outside-to-close to backdrop div** (around line 323-329):
       - Find the second AnimatePresence block with the backdrop div (class `bg-alternative fixed overflow-hidden inset-0 z-40`)
       - Add `onClick={() => setOpen(false)}` to this div
       - Add `cursor-pointer` class for UX clarity

    The backdrop div currently looks like:
    ```tsx
    <m.div
      variants={container}
      initial="hidden"
      animate="show"
      exit="exit"
      className="bg-alternative fixed overflow-hidden inset-0 z-40 h-screen w-screen transform"
    />
    ```

    Should become:
    ```tsx
    <m.div
      variants={container}
      initial="hidden"
      animate="show"
      exit="exit"
      onClick={() => setOpen(false)}
      className="bg-alternative fixed overflow-hidden inset-0 z-40 h-screen w-screen transform cursor-pointer"
    />
    ```
  </action>
  <verify>
    - Grep for `onClick.*setOpen` in MobileMenu.tsx to confirm handler added
    - Grep for `bg-background` or `bg-overlay` in main container
    - Check file has no TypeScript errors: `cd apps/www && npx tsc --noEmit 2>&1 | head -20`
  </verify>
  <done>
    - Mobile menu backdrop div has onClick handler that calls setOpen(false)
    - Mobile menu main container has solid background class
  </done>
</task>

<task type="auto">
  <name>Task 2: Hide hamburger button when mobile menu is open</name>
  <files>apps/www/components/Nav/index.tsx</files>
  <action>
    Fix hamburger/X icon overlap by hiding hamburger when menu is open:

    1. Find the HamburgerButton component usage (around line 192-195):
       ```tsx
       <HamburgerButton
         toggleFlyOut={() => setOpen(true)}
         showLaunchWeekNavMode={showLaunchWeekNavMode}
       />
       ```

    2. Conditionally render based on `open` state - only show when menu is closed:
       ```tsx
       {!open && (
         <HamburgerButton
           toggleFlyOut={() => setOpen(true)}
           showLaunchWeekNavMode={showLaunchWeekNavMode}
         />
       )}
       ```

    This ensures:
    - Hamburger icon shows when menu is closed (open=false)
    - Hamburger icon hides when menu is open (open=true)
    - X close button in MobileMenu.tsx handles closing (already implemented)
  </action>
  <verify>
    - Grep for `!open.*HamburgerButton` or `open &&` patterns in Nav/index.tsx
    - Check file has no TypeScript errors: `cd apps/www && npx tsc --noEmit 2>&1 | head -20`
  </verify>
  <done>
    - HamburgerButton only renders when open state is false
    - No icon overlap between hamburger and X close button
  </done>
</task>

</tasks>

<verification>
After completing both tasks:

1. TypeScript compiles without errors:
   ```bash
   cd apps/www && npx tsc --noEmit
   ```

2. Dev server starts and mobile menu can be tested:
   ```bash
   cd apps/www && pnpm dev
   ```
   - Open browser at localhost:3000 (or assigned port)
   - Resize to mobile viewport (< 1024px width)
   - Click hamburger to open menu
   - Verify solid background (no page content visible through)
   - Verify hamburger icon not visible when menu open
   - Click outside menu area to close
   - Verify menu closes on outside click

3. Grep verification:
   ```bash
   grep -n "onClick.*setOpen" apps/www/components/Nav/MobileMenu.tsx
   grep -n "!open" apps/www/components/Nav/index.tsx
   ```
</verification>

<success_criteria>
- Mobile menu has solid background (bg-background or equivalent)
- Backdrop onClick handler calls setOpen(false)
- HamburgerButton conditionally rendered only when menu is closed
- TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/06-page-structure/06-03-SUMMARY.md`
</output>
