---
phase: 03-project-configuration
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - lib/config/tailwind.config.js
  - apps/www/tailwind.config.js
  - apps/www/postcss.config.js
autonomous: true

must_haves:
  truths:
    - "Tailwind config loads without requiring missing build artifacts"
    - "Tailwind content paths scan lib/ instead of packages/"
    - "PostCSS config is self-contained (no external requires that fail)"
    - "Color stub CSS variables are defined in app global CSS"
  artifacts:
    - path: "lib/config/tailwind.config.js"
      provides: "Tailwind configuration that works without design token build"
      contains: "default-colors"
    - path: "apps/www/tailwind.config.js"
      provides: "App Tailwind config with correct lib/ content paths"
      contains: "lib/ui"
    - path: "apps/www/postcss.config.js"
      provides: "Self-contained PostCSS config"
      contains: "tailwindcss"
  key_links:
    - from: "apps/www/tailwind.config.js"
      to: "lib/config/tailwind.config.js"
      via: "require('config/tailwind.config')"
      pattern: "require.*config/tailwind"
---

<objective>
Fix Tailwind CSS configuration to work without missing design token build artifacts.

Purpose: The current tailwind.config.js requires `lib/ui/build/css/tw-extend/color` which doesn't exist (generated by a build process not included in extraction). This blocks Tailwind from compiling.

Output: Working Tailwind configuration using the existing fallback colors from default-colors.js and @radix-ui/colors.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-project-configuration/03-RESEARCH.md
@lib/config/tailwind.config.js
@lib/config/ui.config.js
@lib/config/default-colors.js
@apps/www/tailwind.config.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove design token build dependency from lib/config/tailwind.config.js</name>
  <files>lib/config/tailwind.config.js</files>
  <action>
The file currently has:
```js
const color = require('./../ui/build/css/tw-extend/color')
```

This file doesn't exist. Replace the entire color token system with a stub that uses CSS variables directly.

**Strategy:** Instead of trying to regenerate the design tokens, create a minimal stub that:
1. Defines the CSS variable names the typography plugin expects (foreground-default, foreground-light, foreground-muted, etc.)
2. Uses hsl(var(--variable-name)) pattern
3. Allows the config to load

**IMPORTANT:** Before creating the stub, verify which CSS variables actually exist in the app's global CSS. First grep for existing variable definitions:
```bash
grep -E "^[[:space:]]*(--|--)[a-z]" apps/www/app/globals.css 2>/dev/null || \
grep -E "^[[:space:]]*(--|--)[a-z]" apps/www/styles/globals.css 2>/dev/null
```

Create a stub color object at the top of the file that references only variables that exist:
```js
// Stub for missing design token build - uses CSS variable names directly
// These CSS variables are defined in the app's global CSS
const color = {
  'foreground-DEFAULT': { cssVariable: 'var(--foreground-default)' },
  'foreground-default': { cssVariable: 'var(--foreground-default)' },
  'foreground-light': { cssVariable: 'var(--foreground-light)' },
  'foreground-lighter': { cssVariable: 'var(--foreground-lighter)' },
  'foreground-muted': { cssVariable: 'var(--foreground-muted)' },
  'background-DEFAULT': { cssVariable: 'var(--background-default)' },
  'background-default': { cssVariable: 'var(--background-default)' },
  'background-alternative-default': { cssVariable: 'var(--background-alternative-default)' },
  'background-selection': { cssVariable: 'var(--background-selection)' },
  'background-surface-100': { cssVariable: 'var(--background-surface-100)' },
  'background-surface-200': { cssVariable: 'var(--background-surface-200)' },
  'background-surface-300': { cssVariable: 'var(--background-surface-300)' },
  'background-200': { cssVariable: 'var(--background-200)' },
  'border-DEFAULT': { cssVariable: 'var(--border-default)' },
  'border-default': { cssVariable: 'var(--border-default)' },
  'border-muted': { cssVariable: 'var(--border-muted)' },
  'border-strong': { cssVariable: 'var(--border-strong)' },
  'brand-default': { cssVariable: 'var(--brand-default)' },
  'brand-300': { cssVariable: 'var(--brand-300)' },
  'brand-500': { cssVariable: 'var(--brand-500)' },
}
```

Remove the require line:
```js
// REMOVED: const color = require('./../ui/build/css/tw-extend/color')
```

The typography plugin and theme extensions will then use these stubs. The actual CSS variable definitions will be provided by the app's global CSS (already exists from Supabase extraction).
  </action>
  <verify>
1. Node can require the config without errors:
```bash
cd apps/www && node -e "require('./tailwind.config.js')" && echo "Tailwind config loads OK"
```

2. Verify stub variables are defined in app CSS (check at least 3 key variables):
```bash
echo "Checking CSS variable definitions..."
for var in foreground-default background-default border-default; do
  grep -q "$var" apps/www/app/globals.css 2>/dev/null || \
  grep -q "$var" apps/www/styles/globals.css 2>/dev/null || \
  grep -q "$var" apps/www/styles/main.css 2>/dev/null && \
    echo "OK: --$var defined" || echo "WARN: --$var not found (may need to add)"
done
```
  </verify>
  <done>lib/config/tailwind.config.js loads without errors and doesn't require missing build artifacts</done>
</task>

<task type="auto">
  <name>Task 2: Update Tailwind content paths and inline PostCSS</name>
  <files>
    apps/www/tailwind.config.js
    apps/www/postcss.config.js
  </files>
  <action>
**apps/www/tailwind.config.js:**

Update content paths from `packages/` to `lib/`:
```js
content: [
  './_blog/*.mdx',
  './components/**/*.tsx',
  './data/**/*.tsx',
  './layouts/**/*.tsx',
  './lib/mdx/mdxComponents.tsx',
  './pages/**/*.{tsx,mdx}',
  './app/**/*.{tsx,ts,js}',
  // Updated from packages/ to lib/
  './../../lib/ui/**/*.{tsx,ts,js}',
  './../../lib/ui-patterns/**/*.{tsx,ts,js}',
],
```

**apps/www/postcss.config.js:**

Currently just `require('config/postcss.config')`. The lib/config/postcss.config.js is minimal (just enables tailwindcss plugin).

Inline it directly:
```js
module.exports = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
}
```

Adding autoprefixer is standard for production builds.
  </action>
  <verify>
1. Verify content paths reference lib/ not packages/:
```bash
grep -c "lib/ui" apps/www/tailwind.config.js && echo "Points to lib/"
grep -c "packages/" apps/www/tailwind.config.js && echo "FAIL: Still references packages/" || echo "OK: No packages/ refs"
```

2. PostCSS loads:
```bash
cd apps/www && node -e "require('./postcss.config.js')" && echo "PostCSS config loads OK"
```
  </verify>
  <done>Content paths point to lib/, PostCSS is self-contained with tailwindcss + autoprefixer</done>
</task>

</tasks>

<verification>
1. `node -e "require('./tailwind.config.js')"` succeeds in apps/www/
2. No references to `packages/` in tailwind content paths
3. No references to missing `lib/ui/build/` directory
4. PostCSS config is self-contained (doesn't require external config module)
5. Color stub CSS variables have corresponding definitions in app global CSS
</verification>

<success_criteria>
- [ ] lib/config/tailwind.config.js doesn't require lib/ui/build/css/tw-extend/color
- [ ] lib/config/tailwind.config.js loads without Node errors
- [ ] Color stub variables verified to exist in app's global CSS (or warnings documented)
- [ ] apps/www/tailwind.config.js content paths reference lib/ui and lib/ui-patterns
- [ ] apps/www/tailwind.config.js has no references to packages/
- [ ] apps/www/postcss.config.js is self-contained with tailwindcss and autoprefixer plugins
</success_criteria>

<output>
After completion, create `.planning/phases/03-project-configuration/03-02-SUMMARY.md`
</output>
