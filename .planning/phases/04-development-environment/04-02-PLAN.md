---
phase: 04-development-environment
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - lib/common/index.ts
  - apps/www/instrumentation.ts
autonomous: true

must_haves:
  truths:
    - "No fatal errors when importing from 'common' package"
    - "Sentry instrumentation does not crash on startup"
  artifacts:
    - path: "lib/common/index.ts"
      provides: "No-op stubs for hooks and utilities"
      exports: ["useBreakpoint", "useFlag", "useIsLoggedIn", "useIsUserLoading", "isBrowser", "detectBrowser", "useReducedMotion", "getAccessToken"]
  key_links:
    - from: "apps/www/components/**"
      to: "lib/common/index.ts"
      via: "import from 'common'"
      pattern: "from 'common'"
---

<objective>
Create no-op stubs for common package exports and fix instrumentation

Purpose: Multiple components import utilities from 'common' package. These need to either work or be stubbed to prevent crashes. Additionally, Sentry instrumentation was noted in Phase 3 as needing removal.

Output: Working common package exports and clean instrumentation file
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-development-environment/04-CONTEXT.md
@lib/common/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Ensure common package exports work or are stubbed</name>
  <files>lib/common/index.ts</files>
  <action>
Check lib/common/index.ts and ensure all commonly imported utilities are exported and functional (or stubbed).

From the codebase grep, these imports are used:
- useBreakpoint - used by many components for responsive logic
- useFlag - feature flags
- useIsLoggedIn, useIsUserLoading - auth state hooks
- isBrowser, detectBrowser - browser detection utilities
- useReducedMotion - accessibility hook
- getAccessToken - auth token retrieval

Read the existing lib/common/index.ts to see what's already exported. For any missing exports, add no-op stub implementations:

```typescript
// No-op stubs for Supabase-specific features (per CONTEXT.md)
export const useFlag = (flag: string) => false
export const useIsLoggedIn = () => false
export const useIsUserLoading = () => false
export const getAccessToken = async () => null
```

For utilities that should actually work:
- useBreakpoint: Should work if it exists, or stub to return 'md' (desktop default)
- isBrowser: Should return typeof window !== 'undefined'
- detectBrowser: Should work or return 'unknown'
- useReducedMotion: Should work or return false

Check if these are already implemented in lib/common/hooks/ or lib/common/utils/ and re-exported. If not, add stubs.
  </action>
  <verify>grep -E "export.*(useBreakpoint|useFlag|useIsLoggedIn|isBrowser)" lib/common/index.ts</verify>
  <done>All commonly imported utilities from 'common' are exported (either real implementations or no-op stubs)</done>
</task>

<task type="auto">
  <name>Task 2: Clean up instrumentation file</name>
  <files>apps/www/instrumentation.ts</files>
  <action>
Read apps/www/instrumentation.ts. Based on Phase 3 decision to "Remove Sentry integration entirely", this file should either:

1. Be emptied to a minimal no-op (if Sentry is the only thing in it)
2. Have Sentry-specific code removed while keeping other instrumentation

Per CONTEXT.md: "Replace with no-ops (keep structure, make functions return null/empty)"

If the file is primarily Sentry instrumentation:
```typescript
// Instrumentation disabled - Sentry removed per Phase 3
export async function register() {
  // No-op
}
```

If there's other instrumentation mixed in, remove only Sentry-related code.

Also check next.config.mjs to see if there's a Sentry webpack plugin reference that should be removed.
  </action>
  <verify>! grep -q "@sentry" apps/www/instrumentation.ts || grep -q "No-op" apps/www/instrumentation.ts</verify>
  <done>Instrumentation file cleaned of Sentry references or converted to no-op</done>
</task>

</tasks>

<verification>
1. Common imports don't crash: node -e "require('./lib/common')" should not error (run from project root)
2. No Sentry in instrumentation: grep -c "@sentry" apps/www/instrumentation.ts should be 0 or file should have no-op comment
</verification>

<success_criteria>
- lib/common/index.ts exports all utilities used by apps/www components
- apps/www/instrumentation.ts has no active Sentry code
- No missing export errors when compiling pages that import from 'common'
</success_criteria>

<output>
After completion, create `.planning/phases/04-development-environment/04-02-SUMMARY.md`
</output>
